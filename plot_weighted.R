##plot the weighted_quadrants
###GDP weighted
quadrants <- read_excel("/Users/kangdi/Desktop/typ/weighted/quatrants_gdp_weighted.xlsx")
png("desktop/typ/weighted/quadrants_gdp_weighted.png", width = 3570, height = 1865, res = 350)
ggplot(quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,50), limits=c(0,1000)) +
  # #lims(y=c(70,110),x=c(-50,250)) +
  #coord_fixed() +  # 
  geom_vline(xintercept = mean(quadrants$To)) + geom_hline(yintercept = mean(quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()


###trade weighted
quadrants <- read_excel("/Users/kangdi/Desktop/typ/weighted/quatrants_trade_weighted.xlsx")
png("desktop/typ/weighted/quadrants_trade_weighted.png", width = 3570, height = 1865, res = 350)
ggplot(quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,50), limits=c(0,1000)) +
  # #lims(y=c(70,110),x=c(-50,250)) +
  #coord_fixed() +  # 
  geom_vline(xintercept = mean(quadrants$To)) + geom_hline(yintercept = mean(quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()

# plot the first and last window
#gdp weighted
FirstWindow_weighted <- read_excel("~/Desktop/typ/weighted/spillover_FirstWindow_gdp.xlsx")
png("desktop/typ/weighted/spillover_FirstWindow_gdp.png", width = 3579, height = 1865, res = 350)
ggplot(FirstWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,50), limits=c(0,950)) +
  geom_vline(xintercept = mean(FirstWindow_weighted$To)) + geom_hline(yintercept = mean(FirstWindow_weighted$From)) + 
  geom_abline(intercept = 0)
dev.off()

LastWindow_weighted <- read_excel("/Users/kangdi/Desktop/typ/weighted/spillover_LastWindow_gdp.xlsx")
png("desktop/typ/weighted/spillover_LastWindow_gdp.png", width = 3570, height = 1865, res = 350)
ggplot(LastWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,50), limits=c(0,1000)) +
  geom_vline(xintercept = mean(LastWindow_weighted$To)) + geom_hline(yintercept = mean(LastWindow_weighted$From)) + 
  geom_abline(intercept = 0)
dev.off()

png("desktop/typ/weighted/spillover_TwoWindows_gdp.png", width = 3000, height = 1500, res = 350)
p1 <- ggplot(FirstWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,100), limits=c(0,1000)) +
  geom_vline(xintercept = mean(FirstWindow_weighted$To)) + geom_hline(yintercept = mean(FirstWindow_weighted$From)) + 
  geom_abline(intercept = 0)
p2 <- ggplot(LastWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,100), limits=c(0,1000)) +
  geom_vline(xintercept = mean(LastWindow_weighted$To)) + geom_hline(yintercept = mean(LastWindow_weighted$From)) + 
  geom_abline(intercept = 0)
plot_grid(p1, p2, labels = c('March, 2007', 'June, 2021'), label_size = 12)
dev.off()

#trade weighted
FirstWindow_weighted <- read_excel("~/Desktop/typ/weighted/spillover_FirstWindow_trade.xlsx")
png("desktop/typ/weighted/spillover_FirstWindow_trade.png", width = 3579, height = 1865, res = 350)
ggplot(FirstWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,50), limits=c(0,950)) +
  geom_vline(xintercept = mean(FirstWindow_weighted$To)) + geom_hline(yintercept = mean(FirstWindow_weighted$From)) + 
  geom_abline(intercept = 0)
dev.off()

LastWindow_weighted <- read_excel("/Users/kangdi/Desktop/typ/weighted/spillover_LastWindow_trade.xlsx")
png("desktop/typ/weighted/spillover_LastWindow_trade.png", width = 3570, height = 1865, res = 350)
ggplot(LastWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,50), limits=c(0,950)) +
  geom_vline(xintercept = mean(LastWindow_weighted$To)) + geom_hline(yintercept = mean(LastWindow_weighted$From)) + 
  geom_abline(intercept = 0)
dev.off()

png("desktop/typ/weighted/spillover_TwoWindows_trade.png", width = 3000, height = 1500, res = 350)
p1 <- ggplot(FirstWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,100), limits=c(0,1000)) +
  geom_vline(xintercept = mean(FirstWindow_weighted$To)) + geom_hline(yintercept = mean(FirstWindow_weighted$From)) + 
  geom_abline(intercept = 0)
p2 <- ggplot(LastWindow_weighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(0,1000,100), limits=c(0,1000)) +
  geom_vline(xintercept = mean(LastWindow_weighted$To)) + geom_hline(yintercept = mean(LastWindow_weighted$From)) + 
  geom_abline(intercept = 0)
plot_grid(p1, p2, labels = c('March, 2007', 'June, 2021'), label_size = 12)
dev.off()

##total
###GDP weighted
png("desktop/typ/weighted/overall_spillovers-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(total_spillover_alasso_gdp, type = "l", las = 2, ylab="", main = 'Overall Spillover', ylim=c(1250,2300))
lines(total_spillover_alasso, lty=3)
abline(v=2007.666667, col="red")
text(x=2008,y=1300,"Aug, 2007,")
text(x=2008,y=1250,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2008,y=2300,"Sep,2008")
text(x=2008,y=2250,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=1900,"Oct, 2009,")
text(x=2010,y=1850,"European debt crisis")
abline(v=2011.583333, col="red")
text(x=2011.5,y=1800,"Sep,2011")
text(x=2011.5,y=1750,"debt ceiling crisis")
abline(v=2014.166667, col="red")
text(x=2014.5,y=1700,"Feb,2014")
text(x=2014.5,y=1650,"Crimean crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=1400,"Jul,2016")
text(x=2016,y=1350,"Trump becomes the nominee")
abline(v=2016.5, col="red")
text(x=2016,y=2100,"Jun,2016")
text(x=2016,y=2050,"'Brexit' referendum")
abline(v=2016.916667, col="red")
text(x=2018,y=1600,"Nov,2016")
text(x=2018,y=1550,"US presidential election")
abline(v=2018.583333, col="red")
text(x=2018.5,y=2200,"Jul,2018")
text(x=2018.5,y=2150,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2021,y=1600,"Feb,2020")
text(x=2021,y=1550,"Covid-19")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

###trade weighted
png("desktop/typ/weighted/overall_spillovers-6_trade.png", width = 4854, height = 3000, res = 350)
plot(total_spillover_alasso_trade, type = "l", las = 2, ylab="", main = 'Total Spillover', ylim=c(1250,2300))
lines(total_spillover_alasso, lty=3)
abline(v=2007.666667, col="red")
text(x=2008,y=1300,"Aug, 2007,")
text(x=2008,y=1250,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2008,y=2300,"Sep,2008")
text(x=2008,y=2250,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=1900,"Oct, 2009,")
text(x=2010,y=1850,"European debt crisis")
abline(v=2011.583333, col="red")
text(x=2011.5,y=1800,"Sep,2011")
text(x=2011.5,y=1750,"debt ceiling crisis")
abline(v=2014.166667, col="red")
text(x=2014.5,y=1700,"Feb,2014")
text(x=2014.5,y=1650,"Crimean crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=1400,"Jul,2016")
text(x=2016,y=1350,"Trump becomes the nominee")
abline(v=2016.5, col="red")
text(x=2016,y=2100,"Jun,2016")
text(x=2016,y=2050,"'Brexit' referendum")
abline(v=2016.916667, col="red")
text(x=2018,y=1600,"Nov,2016")
text(x=2018,y=1550,"US presidential election")
abline(v=2018.583333, col="red")
text(x=2018.5,y=2200,"Jul,2018")
text(x=2018.5,y=2150,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2021,y=1600,"Feb,2020")
text(x=2021,y=1550,"Covid-19")
legend("topright", legend=c("trade-weighted","unweighted"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

##directional spillover
###GDP weighted
#usa
png("desktop/typ/weighted/spillover_usa-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))

plot(to_spillover_alasso_usa_gdp, type = "l", las = 2, ylab="",main = 'USA TO Spillover')
par(new = TRUE)
plot(to_spillover_alasso_usa,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2007.666667, col="red")
abline(v=2008.75, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_usa_gdp, type = "l", las = 2, ylab = '', main = 'USA From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_usa,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2007.666667, col="red")
abline(v=2008.75, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_usa_gdp, type = "l", las = 2, ylab = '', main = 'USA Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_usa,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2007.666667, col="red")
text(x=2008,y=110,"Aug, 2007,")
text(x=2008,y=100,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009,y=150,"Sep,2008")
text(x=2009,y=140,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2011,y=150,"Jul,2011")
text(x=2011,y=140,"debt ceiling crisis")
abline(v=2013.5, col="red")
text(x=2013,y=110,"Jun,2013")
text(x=2013,y=100,"taper tatrum")
abline(v=2014.166667, col="red")
text(x=2014.5,y=80,"Feb,2014")
text(x=2014.5,y=70,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2016,y=50,"Jun,2016")
text(x=2016,y=40,"'Brexit' referendum")
abline(v=2016.583333,col="red")
text(x=2016,y=110,"Jul,2016")
text(x=2016,y=100,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=90,"Nov,2016")
text(x=2018,y=80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=150,"Jan,2018")
text(x=2018.5,y=140,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2021,y=130,"Feb,2020")
text(x=2021,y=120,"Covid-19")
abline(v=2020.25, col="red")
text(x=2021,y=-10,"Mar,2020")
text(x=2021,y=-20,"national lockdown")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#China
png("desktop/typ/weighted/spillover_china-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_China_gdp, type = "l", las = 2, ylab = '', main = 'China To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_China,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.416667, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_China_gdp, type = "l", las = 2, ylab = '', main = 'China From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_China,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.416667, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_China_gdp, type = "l", las = 2, ylab = '', main = 'China Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_China,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2010,y=50,"Sep,2008")
text(x=2010,y=40,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2016,y=40,"Jul,2016")
text(x=2016,y=30,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=-70,"Nov,2016")
text(x=2017.5,y=-80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=50,"Jan,2018")
text(x=2018.5,y=40,"China–United States trade war")
abline(v=2019.416667, col="red")
text(x=2019.5,y=20,"May,2019")
text(x=2019.5,y=10,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=30,"Feb,2020")
text(x=2021,y=20,"Covid-19")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Germany
png("desktop/typ/weighted/spillover_germany-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_Germany_gdp, type = "l", las = 2, ylab = '', main = 'Germany To Spillover', ylim=c(0,250))
par(new = TRUE)
plot(to_spillover_alasso_Germany,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_Germany_gdp, type = "l", las = 2, ylab = '', main = 'Germany From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_Germany,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_Germany_gdp, type = "l", las = 2, ylab = '', main = 'Germany Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_Germany,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2008,y=50,"Sep,2008")
text(x=2008,y=40,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010.5,y=50,"Oct, 2009,")
text(x=2010.5,y=40,"European debt crisis")
abline(v=2016.5, col="red")
text(x=2017.5,y=-10,"Jun,2016")
text(x=2017.5,y=-20,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019,y=80,"Feb,2020")
text(x=2019,y=70,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
abline(v=2020.25, col="red")
text(x=2021,y=-30,"Mar,2020")
text(x=2021,y=-40,"national lockdown")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
dev.off()

#Greece
png("desktop/typ/weighted/spillover_greece-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_Greece_gdp, type = "l", las = 2, ylab = '', main = 'Greece To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_Greece,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)


plot(from_spillover_alasso_Greece_gdp, type = "l", las = 2, ylab = '', main = 'Greece From Spillover', ylim=c(0, 110))
par(new = TRUE)
plot(from_spillover_alasso_Greece,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0, 110))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_Greece_gdp, type = "l", las = 2, ylab = '', main = 'Greece Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_Greece,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2008,y=-40,"Sep,2008")
text(x=2008,y=-50,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=-50,"Oct, 2009,")
text(x=2010,y=-60,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=120,"May,2010")
text(x=2011,y=115,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012,y=60,"Jul,2011")
text(x=2012,y=55,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2016,y=-40,"Jul,2015")
text(x=2016,y=-45,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=20,"Jun,2016")
text(x=2017,y=15,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=40,"Feb,2020")
text(x=2021,y=30,"Covid-19")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#South Korea
png("desktop/typ/weighted/spillover_SK-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_SK_gdp, type = "l", las = 2, ylab = '', main = 'South Korea To Spillover', ylim=c(0,120))
par(new = TRUE)
plot(to_spillover_alasso_SK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="",ylim=c(0,200))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_SK_gdp, type = "l", las = 2, ylab = '', main = 'South Korea From Spillover', ylim=c(0,110))
par(new = TRUE)
plot(from_spillover_alasso_SK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,110))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_SK_gdp, type = "l", las = 2, ylab = '', main = 'South Korea Net Spillover',ylim=c(-100,50))
par(new = TRUE)
plot(net_spillover_alasso_SK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="",ylim=c(-100,120))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2008,y=40,"Sep,2008")
text(x=2008,y=30,"Lehman's collapse")
abline(v=2017.25, col="red")
text(x=2016.5,y=110,"Mar,2017")
text(x=2016.5,y=100,"THAAD")
abline(v=2019.583333, col="red")
text(x=2019,y=-20,"Jul,2019")
text(x=2019,y=-30,"Japan–South Korea trade dispute")
abline(v=2020.166667, col="red")
text(x=2021,y=70,"Feb,2020")
text(x=2021,y=60,"Covid-19")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Mexico
png("desktop/typ/weighted/spillover_mx-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_mx_gdp, type = "l", las = 2, ylab = '', main = 'Mexico To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_mx,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2019.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_mx_gdp, type = "l", las = 2, ylab = '', main = 'Mexico From Spillover', ylim=c(0,110))
par(new = TRUE)
plot(from_spillover_alasso_mx,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,110))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2019.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_mx_gdp, type = "l", las = 2, ylab = '', main = 'Mexico Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_mx,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2009.5,y=20,"Sep,2008")
text(x=2009.5,y=15,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2015.5,y=50,"Jul,2016")
text(x=2015.5,y=45,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=90,"Nov,2016")
text(x=2018,y=80,"US presidential election")
abline(v=2019.5, col="red")
text(x=2019,y=70,"Jun,2019")
text(x=2019,y=60,"Ratification of USMCA")
abline(v=2020.166667, col="red")
text(x=2020,y=-50,"Feb,2020")
text(x=2020,y=-60,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2021,y=80,"Jul,2020")
text(x=2021,y=70,"USMCA takes effect")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Russia
png("desktop/typ/weighted/spillover_russia-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_Russia_gdp, type = "l", las = 2, ylab = '', main = 'Russia To Spillover',ylim=c(0,100))
par(new = TRUE)
plot(to_spillover_alasso_Russia,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="",ylim=c(0,150))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2012, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_Russia_gdp, type = "l", las = 2, ylab = '', main = 'Russia From Spillover', ylim=c(0,120))
par(new = TRUE)
plot(from_spillover_alasso_Russia,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,120))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2012, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_Russia_gdp, type = "l", las = 2, ylab = '', main = 'Russia Net Spillover',ylim=c(-100,50))
par(new = TRUE)
plot(net_spillover_alasso_Russia,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="",ylim=c(-80,50))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2009.5,y=20,"Sep,2008")
text(x=2009.5,y=15,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2011.5,y=20,"Dec,2012")
text(x=2011.5,y=15,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=20,"Feb,2014")
text(x=2014.5,y=15,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2018,y=20,"Jun,2016")
text(x=2018,y=15,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=-40,"Feb,2020")
text(x=2021,y=-45,"Covid-19")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()


#UK
png("desktop/typ/weighted/spillover_uk-6_gdp.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_UK_gdp, type = "l", las = 2, ylab = '', main = 'UK To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_UK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_UK_gdp, type = "l", las = 2, ylab = '', main = 'UK From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_UK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_UK_gdp, type = "l", las = 2, ylab = '', main = 'UK Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_UK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2007.5,y=150,"Sep,2008")
text(x=2007.5,y=130,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=110,"Oct, 2009,")
text(x=2009.5,y=90,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=-70,"May, 2010,")
text(x=2011,y=-90,"UK general election")
abline(v=2013.083333, col="red")
text(x=2014,y=90,"Jan, 2013,")
text(x=2014,y=70,"Cameron's promise")
abline(v=2016.5, col="red")
text(x=2017.5,y=150,"Jun,2016")
text(x=2017.5,y=130,"'Brexit' referendum")
abline(v=2020.167777, col="red")
text(x=2019,y=70,"Feb,2020")
text(x=2019,y=50,"Formal 'Brexit'")
abline(v=2020.25, col="red")
text(x=2021,y=70,"Mar,2020")
text(x=2021,y=50,"national lockdown")
legend("topright", legend=c("GDP-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

###trade weighted
#usa
png("desktop/typ/weighted/spillover_usa-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))

plot(to_spillover_alasso_usa_trade, type = "l", las = 2, ylab="",main = 'USA TO Spillover')
par(new = TRUE)
plot(to_spillover_alasso_usa,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2007.666667, col="red")
abline(v=2008.75, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_usa_trade, type = "l", las = 2, ylab = '', main = 'USA From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_usa,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2007.666667, col="red")
abline(v=2008.75, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_usa_trade, type = "l", las = 2, ylab = '', main = 'USA Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_usa,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2007.666667, col="red")
text(x=2008,y=110,"Aug, 2007,")
text(x=2008,y=100,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009,y=150,"Sep,2008")
text(x=2009,y=140,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2011,y=150,"Jul,2011")
text(x=2011,y=140,"debt ceiling crisis")
abline(v=2013.5, col="red")
text(x=2013,y=110,"Jun,2013")
text(x=2013,y=100,"taper tatrum")
abline(v=2014.166667, col="red")
text(x=2014.5,y=80,"Feb,2014")
text(x=2014.5,y=70,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2016,y=50,"Jun,2016")
text(x=2016,y=40,"'Brexit' referendum")
abline(v=2016.583333,col="red")
text(x=2016,y=110,"Jul,2016")
text(x=2016,y=100,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=90,"Nov,2016")
text(x=2018,y=80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=150,"Jan,2018")
text(x=2018.5,y=140,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2021,y=130,"Feb,2020")
text(x=2021,y=120,"Covid-19")
abline(v=2020.25, col="red")
text(x=2021,y=-10,"Mar,2020")
text(x=2021,y=-20,"national lockdown")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#China
png("desktop/typ/weighted/spillover_china-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_China_trade, type = "l", las = 2, ylab = '', main = 'China To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_China,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.416667, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_China_trade, type = "l", las = 2, ylab = '', main = 'China From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_China,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.416667, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_China_trade, type = "l", las = 2, ylab = '', main = 'China Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_China,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2010,y=50,"Sep,2008")
text(x=2010,y=40,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2016,y=40,"Jul,2016")
text(x=2016,y=30,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=-70,"Nov,2016")
text(x=2017.5,y=-80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=50,"Jan,2018")
text(x=2018.5,y=40,"China–United States trade war")
abline(v=2019.416667, col="red")
text(x=2019.5,y=20,"May,2019")
text(x=2019.5,y=10,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=30,"Feb,2020")
text(x=2021,y=20,"Covid-19")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Germany
png("desktop/typ/weighted/spillover_germany-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_Germany_trade, type = "l", las = 2, ylab = '', main = 'Germany To Spillover', ylim=c(50,500))
par(new = TRUE)
plot(to_spillover_alasso_Germany,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,200))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_Germany_trade, type = "l", las = 2, ylab = '', main = 'Germany From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_Germany,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_Germany_trade, type = "l", las = 2, ylab = '', main = 'Germany Net Spillover', ylim=c(-50,500))
par(new = TRUE)
plot(net_spillover_alasso_Germany,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(-100,150))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2008,y=50,"Sep,2008")
text(x=2008,y=40,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010.5,y=50,"Oct, 2009,")
text(x=2010.5,y=40,"European debt crisis")
abline(v=2016.5, col="red")
text(x=2017.5,y=-10,"Jun,2016")
text(x=2017.5,y=-20,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019,y=80,"Feb,2020")
text(x=2019,y=70,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
abline(v=2020.25, col="red")
text(x=2021,y=-30,"Mar,2020")
text(x=2021,y=-40,"national lockdown")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
dev.off()

#Greece
png("desktop/typ/weighted/spillover_greece-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_Greece_trade, type = "l", las = 2, ylab = '', main = 'Greece To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_Greece,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)


plot(from_spillover_alasso_Greece_trade, type = "l", las = 2, ylab = '', main = 'Greece From Spillover', ylim=c(0, 110))
par(new = TRUE)
plot(from_spillover_alasso_Greece,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0, 110))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_Greece_trade, type = "l", las = 2, ylab = '', main = 'Greece Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_Greece,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2008,y=-40,"Sep,2008")
text(x=2008,y=-50,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=-50,"Oct, 2009,")
text(x=2010,y=-60,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=120,"May,2010")
text(x=2011,y=115,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012,y=60,"Jul,2011")
text(x=2012,y=55,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2016,y=-40,"Jul,2015")
text(x=2016,y=-45,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=20,"Jun,2016")
text(x=2017,y=15,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=40,"Feb,2020")
text(x=2021,y=30,"Covid-19")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#South Korea
png("desktop/typ/weighted/spillover_SK-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_SK_trade, type = "l", las = 2, ylab = '', main = 'South Korea To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_SK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_SK_trade, type = "l", las = 2, ylab = '', main = 'South Korea From Spillover', ylim=c(0,110))
par(new = TRUE)
plot(from_spillover_alasso_SK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,110))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_SK_trade, type = "l", las = 2, ylab = '', main = 'South Korea Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_SK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2008,y=40,"Sep,2008")
text(x=2008,y=30,"Lehman's collapse")
abline(v=2017.25, col="red")
text(x=2016.5,y=100,"Mar,2017")
text(x=2016.5,y=90,"THAAD")
abline(v=2019.583333, col="red")
text(x=2019,y=-20,"Jul,2019")
text(x=2019,y=-30,"Japan–South Korea trade dispute")
abline(v=2020.166667, col="red")
text(x=2021,y=70,"Feb,2020")
text(x=2021,y=60,"Covid-19")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Mexico
png("desktop/typ/weighted/spillover_mx-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_mx_trade, type = "l", las = 2, ylab = '', main = 'Mexico To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_mx,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2019.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_mx_trade, type = "l", las = 2, ylab = '', main = 'Mexico From Spillover', ylim=c(0,110))
par(new = TRUE)
plot(from_spillover_alasso_mx,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,110))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2019.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_mx_trade, type = "l", las = 2, ylab = '', main = 'Mexico Net Spillover', ylim=c(-90,40))
par(new = TRUE)
plot(net_spillover_alasso_mx,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(-70,140))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2009.5,y=25,"Sep,2008")
text(x=2009.5,y=15,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2015.5,y=65,"Jul,2016")
text(x=2015.5,y=55,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=110,"Nov,2016")
text(x=2018,y=100,"US presidential election")
abline(v=2019.5, col="red")
text(x=2019,y=130,"Jun,2019")
text(x=2019,y=120,"Ratification of USMCA")
abline(v=2020.166667, col="red")
text(x=2020,y=-50,"Feb,2020")
text(x=2020,y=-60,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2021,y=80,"Jul,2020")
text(x=2021,y=70,"USMCA takes effect")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Russia
png("desktop/typ/weighted/spillover_russia-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_Russia_trade, type = "l", las = 2, ylab = '', main = 'Russia To Spillover', ylim=c(0,100))
par(new = TRUE)
plot(to_spillover_alasso_Russia,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="",ylim=c(0,150))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2012, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_Russia_trade, type = "l", las = 2, ylab = '', main = 'Russia From Spillover', ylim=c(0,120))
par(new = TRUE)
plot(from_spillover_alasso_Russia,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,120))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2012, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_Russia_trade, type = "l", las = 2, ylab = '', main = 'Russia Net Spillover',ylim=c(-100,50))
par(new = TRUE)
plot(net_spillover_alasso_Russia,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="",ylim=c(-80,50))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2009.5,y=20,"Sep,2008")
text(x=2009.5,y=15,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2011.5,y=20,"Dec,2012")
text(x=2011.5,y=15,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=20,"Feb,2014")
text(x=2014.5,y=15,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2018,y=20,"Jun,2016")
text(x=2018,y=15,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=-40,"Feb,2020")
text(x=2021,y=-45,"Covid-19")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()


#UK
png("desktop/typ/weighted/spillover_uk-6_trade.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_alasso_UK_trade, type = "l", las = 2, ylab = '', main = 'UK To Spillover')
par(new = TRUE)
plot(to_spillover_alasso_UK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_alasso_UK_trade, type = "l", las = 2, ylab = '', main = 'UK From Spillover', ylim=c(0,100))
par(new = TRUE)
plot(from_spillover_alasso_UK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="", ylim=c(0,100))
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_alasso_UK_trade, type = "l", las = 2, ylab = '', main = 'UK Net Spillover')
par(new = TRUE)
plot(net_spillover_alasso_UK,  lty=3, col = "red", yaxt="n", xaxt="n", ylab="", xlab="")
axis(4, col = "red", col.axis="red")
abline(v=2008.75, col="red")
text(x=2007.5,y=150,"Sep,2008")
text(x=2007.5,y=130,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=110,"Oct, 2009,")
text(x=2009.5,y=90,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=-70,"May, 2010,")
text(x=2011,y=-90,"UK general election")
abline(v=2013.083333, col="red")
text(x=2014,y=90,"Jan, 2013,")
text(x=2014,y=70,"Cameron's promise")
abline(v=2016.5, col="red")
text(x=2017.5,y=150,"Jun,2016")
text(x=2017.5,y=130,"'Brexit' referendum")
abline(v=2020.167777, col="red")
text(x=2019,y=70,"Feb,2020")
text(x=2019,y=50,"Formal 'Brexit'")
abline(v=2020.25, col="red")
text(x=2021,y=70,"Mar,2020")
text(x=2021,y=50,"national lockdown")
legend("topright", legend=c("Trade-weighted","unweighted"), lty=c(1,3), col=c("black","red"))
axis(1, at = c(2007:2022), las = 2)
dev.off()


##pairwise
#gdp weighted
png("desktop/typ/weighted/pairwise_us_cn-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoCN_gdp, type = "l",  main = 'US-China', las = 2, ylab = '')
lines(cnct_alasso_CNtoUS_gdp, lty=3)
lines(zero, lty=2)
abline(v=2007.666667, col="red")
text(x=2008,y=40,"Aug, 2007,")
text(x=2008,y=35,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2010,y=15,"Sep,2008")
text(x=2010,y=10,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2012,y=35,"Jul,2011")
text(x=2012,y=30,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2014,y=30,"Jan,2013")
text(x=2014,y=25,"2013 debt ceiling crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=40,"Jul,2016")
text(x=2016,y=35,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017,y=15,"Nov,2016")
text(x=2017,y=10 ,"US presidential election")
abline(v=2017.083333, col="red")
text(x=2017.5,y=25,"Jan,2017")
text(x=2017.5,y=20,"Inauguration")
abline(v=2017.916667, col="red")
text(x=2018,y=50,"Nov,2017")
text(x=2018,y=45,"Solar Panels and")
text(x=2018,y=40,"washing machines")
abline(v=2019.416667, col="red")
text(x=2019.5,y=30,"May,2019")
text(x=2019.5,y=25,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=25,"Feb,2020")
text(x=2021,y=20,"Covid-19")
legend("topright", legend=c("United States","China"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_us_mx-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoMX_gdp, type = "l", main = 'US-Mexico', las = 2, ylab = '', ylim = c(0,70))
lines(cnct_alasso_MXtoUS_gdp, lty=3)
lines(zero, lty=2)
abline(v=2007.666667, col="red")
text(x=2008,y=70,"Aug, 2007")
text(x=2008,y=65,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009,y=20,"Sep,2008")
text(x=2009,y=15,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2010.5,y=30,"Jul,2011")
text(x=2010.5,y=25,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2012,y=60,"Jan,2013")
text(x=2012,y=55,"2013 debt ceiling crisis")
abline(v=2014.583333, col="red")
text(x=2014.5,y=55,"Jul,2014")
text(x=2014.5,y=50,"American immigration crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=70,"Jul,2017")
text(x=2016,y=65,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=35,"Nov,2016")
text(x=2017.5,y=30,"US presidential election")
abline(v=2018.75, col="red")
text(x=2018,y=20,"Aug,2018")
text(x=2018,y=15,"Settlement between the US and Mexico")
abline(v=2019.5, col="red")
text(x=2019.5,y=45,"Jun,2019")
text(x=2019.5,y=40,"Ratification of Mexico ")
abline(v=2020.166667, col="red")
text(x=2020.25,y=10,"Feb,2020")
text(x=2020.25,y=5,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2020.75,y=60,"Jul,2020")
text(x=2020.75,y=55,"USMCA takes effect")
legend("topright", legend=c("United States","Mexico"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_us_ru-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoRU_gdp, type = "l", main = 'US-Russia', las = 2, ylab = '', ylim=c(0,70))
lines(cnct_alasso_RUtoUS_gdp, lty=3)
lines(zero, lty=2)
abline(v=2008.75, col="red")
text(x=2008,y=60,"Sep,2008")
text(x=2008,y=55,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2012.5,y=50,"Dec,2012")
text(x=2012.5,y=45,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=30,"Feb,2014")
text(x=2014.5,y=25,"Crimean crisis")
abline(v=2016.416667,col="red")
text(x=2016,y=50,"May,2017")
text(x=2016,y=45,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=20,"Nov,2016")
text(x=2017.5,y=15,"US presidential election")
abline(v=2020.166667, col="red")
text(x=2020.5,y=30,"Feb,2020")
text(x=2020.5,y=25,"Covid-19")
legend("topright", legend=c("United States","Russia"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_cn_hk-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_CNtoHK_gdp, type = "l", main = 'China-HK', las = 2, ylab = '', ylim=c(0,40))
lines(cnct_alasso_HKtoCN_gdp, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("HK","China"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2009,y=35,"Sep,2008")
text(x=2009,y=32,"Lehman's collapse")
abline(v=2014.75, col="red")
text(x=2014.5,y=31,"Sep,2014")
text(x=2014.5,y=28,"OCLP")
abline(v=2018.083333, col="red")
text(x=2017,y=6,"Jan,2018")
text(x=2017,y=3,"China–United States trade war")
abline(v=2019.25, col="red")
text(x=2018.5,y=38,"Mar,2019")
text(x=2018.5,y=35,"2019 Hong Kong protest")
abline(v=2019.416667, col="red")
text(x=2020,y=21,"May,2019")
text(x=2020,y=18,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=8,"Feb,2020")
text(x=2021,y=5,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_cn_sk-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_SKtoCN_gdp, type = "l", lty=3, main = 'China-South Korea', las = 2, ylab = '', ylim=c(0,45))
lines(cnct_alasso_CNtoSK_gdp)
lines(zero, lty=2)
abline(v=2008.75, col="red")
text(x=2008,y=11,"Sep,2008")
text(x=2008,y=9,"Lehman's collapse")
abline(v=2017.25, col="red")
text(x=2016.5,y=14,"Mar,2017")
text(x=2016.5,y=12,"THAAD")
abline(v=2018.083333, col="red")
text(x=2018.5,y=20,"Jan,2018")
text(x=2018.5,y=18,"China–United States trade war")
abline(v=2019.416667, col="red")
text(x=2019,y=13,"May,2019")
text(x=2019,y=11,"Entity List")
abline(v=2020.166667, col="red")
text(x=2020.5,y=30,"Feb,2020")
text(x=2020.5,y=28,"Covid-19")
legend("topright", legend=c("South Korea","China"), lty=c(3,1))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_gr_ge-6_gdp.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_GRtoGE_gdp, type = "l", main = 'Germany-Greece', las = 2, ylab = '')
lines(cnct_alasso_GEtoGR_gdp, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("Germany","Greece"), lty=c(1,3))
abline(v=2008.75, col="red")
text(x=2008,y=6,"Sep,2008")
text(x=2008,y=5,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=7,"Oct, 2009,")
text(x=2009.5,y=6,"euro debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=13,"May,2010")
text(x=2011,y=12,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012.5,y=4,"Jul,2011")
text(x=2012.5,y=3,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2015,y=4,"Jul,2015")
text(x=2015,y=3,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=10,"Jun,2016")
text(x=2017,y=9,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019.5,y=5,"Feb,2020")
text(x=2019.5,y=4,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

#trade weighted
#gdp weighted
png("desktop/typ/weighted/pairwise_us_cn-6_trade.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoCN_trade, type = "l",  main = 'US-China', las = 2, ylab = '')
lines(cnct_alasso_CNtoUS_trade, lty=3)
lines(zero, lty=2)
abline(v=2007.666667, col="red")
text(x=2008,y=15,"Aug, 2007,")
text(x=2008,y=13,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2010,y=12,"Sep,2008")
text(x=2010,y=10,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2012,y=20,"Jul,2011")
text(x=2012,y=18,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2014,y=25,"Jan,2013")
text(x=2014,y=23,"2013 debt ceiling crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=30,"Jul,2016")
text(x=2016,y=28,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017,y=22,"Nov,2016")
text(x=2017,y=20 ,"US presidential election")
abline(v=2017.083333, col="red")
text(x=2017.5,y=34,"Jan,2017")
text(x=2017.5,y=32,"Inauguration")
abline(v=2017.916667, col="red")
text(x=2018,y=15,"Nov,2017")
text(x=2018,y=13,"Solar Panels and")
text(x=2018,y=11,"washing machines")
abline(v=2019.46667, col="red")
text(x=2019.5,y=30,"May,2019")
text(x=2019.5,y=28,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=25,"Feb,2020")
text(x=2021,y=23,"Covid-19")
legend("topright", legend=c("United States","China"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_us_mx-6_trade.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoMX_trade, type = "l", main = 'US-Mexico', las = 2, ylab = '', ylim = c(0,50))
lines(cnct_alasso_MXtoUS_trade, lty=3)
lines(zero, lty=2)
abline(v=2007.666667, col="red")
text(x=2008,y=40,"Aug, 2007")
text(x=2008,y=35,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009,y=10,"Sep,2008")
text(x=2009,y=5,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2010.5,y=20,"Jul,2011")
text(x=2010.5,y=15,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2012,y=40,"Jan,2013")
text(x=2012,y=35,"2013 debt ceiling crisis")
abline(v=2014.583333, col="red")
text(x=2014.5,y=35,"Jul,2014")
text(x=2014.5,y=30,"American immigration crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=50,"Jul,2017")
text(x=2016,y=45,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=25,"Nov,2016")
text(x=2017.5,y=20,"US presidential election")
abline(v=2018.75, col="red")
text(x=2018,y=15,"Aug,2018")
text(x=2018,y=10,"Settlement between the US and Mexico")
abline(v=2019.5, col="red")
text(x=2019.5,y=30,"Jun,2019")
text(x=2019.5,y=25,"Ratification of Mexico ")
abline(v=2020.166667, col="red")
text(x=2020.25,y=5,"Feb,2020")
text(x=2020.25,y=0,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2020.75,y=40,"Jul,2020")
text(x=2020.75,y=35,"USMCA takes effect")
legend("topright", legend=c("United States","Mexico"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_us_ru-6_trade.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoRU_trade, type = "l", main = 'US-Russia', las = 2, ylab = '', ylim=c(0,45))
lines(cnct_alasso_RUtoUS_trade, lty=3)
lines(zero, lty=2)
abline(v=2008.75, col="red")
text(x=2008,y=40,"Sep,2008")
text(x=2008,y=35,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2012.5,y=30,"Dec,2012")
text(x=2012.5,y=25,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=15,"Feb,2014")
text(x=2014.5,y=10,"Crimean crisis")
abline(v=2016.416667,col="red")
text(x=2016,y=35,"May,2017")
text(x=2016,y=30,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=15,"Nov,2016")
text(x=2017.5,y=10,"US presidential election")
abline(v=2020.166667, col="red")
text(x=2020.5,y=10,"Feb,2020")
text(x=2020.5,y=5,"Covid-19")
legend("topright", legend=c("United States","Russia"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_cn_hk-6_trade.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_CNtoHK_trade, type = "l", main = 'China-HK', las = 2, ylab = '', ylim=c(0,30))
lines(cnct_alasso_HKtoCN_trade, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("HK","China"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2009,y=25,"Sep,2008")
text(x=2009,y=22,"Lehman's collapse")
abline(v=2014.75, col="red")
text(x=2014.5,y=21,"Sep,2014")
text(x=2014.5,y=18,"OCLP")
abline(v=2018.083333, col="red")
text(x=2017,y=6,"Jan,2018")
text(x=2017,y=3,"China–United States trade war")
abline(v=2019.25, col="red")
text(x=2018.5,y=28,"Mar,2019")
text(x=2018.5,y=25,"2019 Hong Kong protest")
abline(v=2019.416667, col="red")
text(x=2020,y=13,"May,2019")
text(x=2020,y=10,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=6,"Feb,2020")
text(x=2021,y=3,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_cn_sk-6_trade.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_SKtoCN_trade, type = "l", lty=3, main = 'China-South Korea', las = 2, ylab = '', ylim=c(0,35))
lines(cnct_alasso_CNtoSK_trade)
lines(zero, lty=2)
abline(v=2008.75, col="red")
text(x=2008,y=11,"Sep,2008")
text(x=2008,y=9,"Lehman's collapse")
abline(v=2017.25, col="red")
text(x=2016.5,y=14,"Mar,2017")
text(x=2016.5,y=12,"THAAD")
abline(v=2018.083333, col="red")
text(x=2018.5,y=20,"Jan,2018")
text(x=2018.5,y=18,"China–United States trade war")
abline(v=2019.416667, col="red")
text(x=2019,y=13,"May,2019")
text(x=2019,y=11,"Entity List")
abline(v=2020.166667, col="red")
text(x=2020.5,y=30,"Feb,2020")
text(x=2020.5,y=28,"Covid-19")
legend("topright", legend=c("South Korea","China"), lty=c(3,1))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/weighted/pairwise_gr_ge-6_trade.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_GRtoGE_trade, type = "l", main = 'Germany-Greece', las = 2, ylab = '')
lines(cnct_alasso_GEtoGR_trade, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("Germany","Greece"), lty=c(1,3))
abline(v=2008.75, col="red")
text(x=2008,y=10,"Sep,2008")
text(x=2008,y=7,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=15,"Oct, 2009,")
text(x=2009.5,y=12,"euro debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=20,"May,2010")
text(x=2011,y=22,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012.5,y=5,"Jul,2011")
text(x=2012.5,y=3,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2015,y=12,"Jul,2015")
text(x=2015,y=10,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=20,"Jun,2016")
text(x=2017,y=18,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019.5,y=25,"Feb,2020")
text(x=2019.5,y=23,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()