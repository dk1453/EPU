library(cowplot)
# plot the quadrants
cnct_ols_quadrants <- read_excel("~/Desktop/var(2)/cnct_ols_quadrants.xlsx")
lags3_static_quadrants_unweighted <- read_excel("~/Desktop/var(2)/3lags_static_quadrant_unweighted.xlsx")
lags3_static_quadrants <- read_excel("~/Desktop/var(2)/3lags_static_quadrant.xlsx")

png("desktop/var(2)/three_quadrants.png", width = 3000, height = 4854, res = 350)
p1 <- ggplot(cnct_ols_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(50,100)) + 
  scale_x_continuous(breaks=seq(0,200,10), limits=c(0,160)) +
  # #lims(y=c(70,110),x=c(-50,250)) +
  #coord_fixed() +  # 
  geom_vline(xintercept = mean(cnct_ols_quadrants$To)) + geom_hline(yintercept = mean(cnct_ols_quadrants$From)) + 
  geom_abline(intercept = 0)
p2 <- ggplot(lags3_static_quadrants_unweighted, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(50,100)) + 
  scale_x_continuous(breaks=seq(0,200,10), limits=c(0,160)) +
  # #lims(y=c(70,110),x=c(-50,250)) +
  #coord_fixed() +  # 
  geom_vline(xintercept = mean(lags3_static_quadrants_unweighted$To)) + geom_hline(yintercept = mean(lags3_static_quadrants_unweighted$From)) + 
  geom_abline(intercept = 0)
p3 <- ggplot(lags3_static_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(50,100)) + 
  scale_x_continuous(breaks=seq(0,200,10), limits=c(0,160)) +
  # #lims(y=c(70,110),x=c(-50,250)) +
  #coord_fixed() +  # 
  geom_vline(xintercept = mean(lags3_static_quadrants$To)) + geom_hline(yintercept = mean(lags3_static_quadrants$From)) + 
  geom_abline(intercept = -2.881531)
plot_grid(p1, p2, p3, nrow = 3, labels = c('OLS VAR(1)', 'aLasso VAR(3) unweighted', 'aLasso VAR(3) weighted'), label_size = 12)
dev.off()

### DYNAMIC
###number of nonzero variables
png("desktop/var(2)/dynamic/number of nonzero coefficients1.png", width = 4854, height = 3000, res = 350)
plot(num_nonzero_coef_1st_lag, type = "l", las = 2, ylab="",  yaxt='n', main = '', ylim=c(0.3,0.7))
lines(num_nonzero_coef_2nd_lag, lty = 3)
legend("topright", legend=c("first lag","second lag"), lty = c(1,3))
axis(1, at = c(2008:2022), las = 2)
axis(2, at=seq(0, 1, by=0.1))
dev.off()

#Total spillover
png("desktop/var(2)/dynamic/Weighted_Total_spillovers_2lags_gdp60.png", width = 4854, height = 3000, res = 350)
plot(Weighted_2lags_Total, type = "l", las = 2, ylab="", main = 'Weighted Total Spillover', ylim=c(1600,2400))
lines(sum_spillover_ols,lty=3)
abline(v=2008.75, col="red")
text(x=2008.5,y=1700,"Sep,2008")
text(x=2008.5,y=1670,"Lehman's collapse")
abline(v=2020.166667, col="red")
text(x=2021,y=2080,"Feb,2020")
text(x=2021,y=2050,"Covid-19")
legend("topright", legend=c("aLasso weighted VAR(2)","OLS unweighted VAR(1)"), lty=c(1,3))
axis(1, at = c(2008:2022), las = 2)
dev.off()

###country level
#australia
png("desktop/var(2)/dynamic/Australia60.png", width = 4854, height = 3000, res = 350)
plot(Australia_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Australia Spillover')
lines(Australia_FROM, lty=3)
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
abline(v=2008.75, col="red")
text(x=2009,y=250,"Sep,2008")
text(x=2009,y=240,"Lehman's collapse")
abline(v=2009.166667, col="red")
text(x=2010,y=300,"Feb,2009")
text(x=2010,y=290,"economic stimulus package")
abline(v=2020.166667, col="red")
text(x=2020.5,y=250,"Feb,2020")
text(x=2020.5,y=240,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

#us
png("desktop/var(2)/dynamic/US60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(US_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(US_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=50,"Sep,2008")
text(x=2009,y=40,"Lehman's collapse")
abline(v=2008.916667, col="red")
text(x=2010,y=230,"Nov,2008")
text(x=2010,y=220,"quantitative easing")
abline(v=2011.583333, col="red")
text(x=2011,y=250,"Jul,2011")
text(x=2011,y=240,"debt ceiling crisis")
abline(v=2013.5, col="red")
text(x=2013,y=110,"Jun,2013")
text(x=2013,y=100,"taper tatrum")
abline(v=2013.833333, col="red")
text(x=2014,y=170,"Oct,2013")
text(x=2014,y=160,"federal government shutdown")
abline(v=2014.166667, col="red")
text(x=2014.5,y=90,"Feb,2014")
text(x=2014.5,y=80,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2016,y=250,"Jun,2016")
text(x=2016,y=240,"'Brexit' referendum")
abline(v=2016.583333,col="red")
text(x=2016,y=210,"Jul,2016")
text(x=2016,y=200,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017,y=180,"Nov,2016")
text(x=2017,y=170,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018,y=240,"Jan,2018")
text(x=2018,y=230,"China–United States trade war")
abline(v=2019.75, col="red")
text(x=2019.5,y=220,"Sep,2019")
text(x=2019.5,y=210,"Impeachment inquiry against Trump")
abline(v=2020.166667, col="red")
text(x=2020.5,y=200,"Feb,2020")
text(x=2020.5,y=190,"Covid-19")
abline(v=2020.25, col="red")
text(x=2021,y=70,"Mar,2020")
text(x=2021,y=60,"national lockdown")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(US_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(US_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2008.916667, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2013.833333, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.75, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_usa, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_usa, lty=3)
abline(v=2008.75, col="red")
abline(v=2008.916667, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2013.833333, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.75, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#china
png("desktop/var(2)/dynamic/China60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(China_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(China_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=30,"Sep,2008")
text(x=2009,y=20,"Lehman's collapse")
abline(v=2008.916667, col="red")
text(x=2010,y=110,"Nov,2008")
text(x=2010,y=100,"Chinese economic stimulus plan")
abline(v=2015.666667,col="red")
text(x=2015.5,y=120,"Aug,2015")
text(x=2015.5,y=110,"stock market crash")
abline(v=2016.583333,col="red")
text(x=2016,y=30,"Jul,2016")
text(x=2016,y=20,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=90,"Nov,2016")
text(x=2017.5,y=80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=120,"Jan,2018")
text(x=2018.5,y=110,"China–United States trade war")
abline(v=2018.5, col="red")
text(x=2019.5,y=30,"June,2018")
text(x=2019.5,y=20,"China retaliates")
abline(v=2020.083333, col="red")
text(x=2021,y=100,"Jan,2020")
text(x=2021,y=90,"Covid-19")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(China_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(China_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2008.916667, col="red")
abline(v=2015.666667,col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2018.5, col="red")
abline(v=2020.083333, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_China, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_China, lty=3)
abline(v=2008.75, col="red")
abline(v=2008.916667, col="red")
abline(v=2015.666667,col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2018.5, col="red")
abline(v=2020.083333, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#germany
png("desktop/var(2)/dynamic/Germany60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(Germany_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(Germany_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=130,"Sep,2008")
text(x=2009,y=120,"Lehman's collapse")
abline(v=2010, col="red")
text(x=2010.5,y=150,"Dec, 2009,")
text(x=2010.5,y=140,"European debt crisis")
abline(v=2011.833333, col="red")
text(x=2012.5,y=200,"Oct, 2010,")
text(x=2012.5,y=190,"EU summit")
abline(v=2016.5, col="red")
text(x=2017.5,y=70,"Jun,2016")
text(x=2017.5,y=60,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019,y=180,"Feb,2020")
text(x=2019,y=170,"Covid-19")
abline(v=2020.25, col="red")
text(x=2021,y=60,"Mar,2020")
text(x=2021,y=50,"national lockdown")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(Germany_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(Germany_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2010, col="red")
abline(v=2011.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_Germany, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_Germany, lty=3)
abline(v=2008.75, col="red")
abline(v=2010, col="red")
abline(v=2011.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#greece
png("desktop/var(2)/dynamic/Greece60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(Greece_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(Greece_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2008.5,y=150,"Sep,2008")
text(x=2008.5,y=140,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=20,"Oct, 2009,")
text(x=2010,y=10,"Pasok wins election")
abline(v=2010, col="red")
text(x=2010.5,y=70,"Dec, 2009,")
text(x=2010.5,y=60,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=50,"May,2010")
text(x=2011,y=40,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012.5,y=70,"Jul,2011")
text(x=2012.5,y=60,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2016,y=140,"Jul,2015")
text(x=2016,y=130,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=110,"Jun,2016")
text(x=2017,y=100,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=130,"Feb,2020")
text(x=2021,y=120,"Covid-19")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(Greece_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(Greece_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_Greece, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_Greece, lty=3)
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()


#UK
png("desktop/var(2)/dynamic/UK60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(UK_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(UK_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2008.5,y=60,"Sep,2008")
text(x=2008.5,y=50,"Lehman's collapse")
abline(v=2008.916667, col="red")
text(x=2010,y=250,"Nov,2008")
text(x=2010,y=240,"fiscal stimulus package")
abline(v=2010, col="red")
text(x=2010.5,y=50,"Oct, 2009,")
text(x=2010.5,y=40,"European debt crisis")
abline(v=2013.083333, col="red")
text(x=2014,y=110,"Jan, 2013,")
text(x=2014,y=100,"Cameron's promise")
abline(v=2016.5, col="red")
text(x=2017.5,y=150,"Jun,2016")
text(x=2017.5,y=140,"'Brexit' referendum")
abline(v=2020.167777, col="red")
text(x=2019.5,y=160,"Feb,2020")
text(x=2019.5,y=150,"Formal 'Brexit'")
abline(v=2020.25, col="red")
text(x=2021,y=70,"Mar,2020")
text(x=2021,y=60,"national lockdown")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(UK_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(UK_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2008.916667, col="red")
abline(v=2010, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_UK, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_UK, lty=3)
abline(v=2008.75, col="red")
abline(v=2008.916667, col="red")
abline(v=2010, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#russia
png("desktop/var(2)/dynamic/Russia60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(Russia_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(Russia_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2009.5,y=130,"Sep,2008")
text(x=2009.5,y=120,"Lehman's collapse")
abline(v=2014.166667, col="red")
text(x=2014.5,y=100,"Feb,2014")
text(x=2014.5,y=90,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2018,y=120,"Jun,2016")
text(x=2018,y=110,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=30,"July,2020")
text(x=2021,y=20,"constitutional referendum")
abline(v=2020.583333, col="red")
text(x=2019.5,y=130,"Feb,2020")
text(x=2019.5,y=120,"Covid-19")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(Russia_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(Russia_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_Russia, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_Russia, lty=3)
abline(v=2008.75, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()


#sk
png("desktop/var(2)/dynamic/SK60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(SK_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(SK_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=140,"Sep,2008")
text(x=2009,y=130,"Lehman's collapse")
abline(v=2017, col="red")
text(x=2016,y=210,"Dec,2016")
text(x=2016,y=200,"Impeachment of Park Geun-hye")
abline(v=2017.25, col="red")
text(x=2018,y=70,"Mar,2017")
text(x=2018,y=60,"THAAD")
abline(v=2019.583333, col="red")
text(x=2019,y=110,"Jul,2019")
text(x=2019,y=100,"Japan–South Korea trade dispute")
abline(v=2020.166667, col="red")
text(x=2021,y=150,"Feb,2020")
text(x=2021,y=140,"Covid-19")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(SK_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(SK_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2017, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_SK, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_SK, lty=3)
abline(v=2008.75, col="red")
abline(v=2017, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()


#mexico
png("desktop/var(2)/dynamic/Mexico60.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(Mexico_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Weighted VAR(2)')
lines(Mexico_FROM, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=140,"Sep,2008")
text(x=2009,y=130,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2015.5,y=150,"Jul,2016")
text(x=2015.5,y=140,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=40,"Nov,2016")
text(x=2018,y=30,"US presidential election")
abline(v=2018.916666, col="red")
text(x=2019,y=160,"Nov,2018")
text(x=2019,y=150,"USMCA is signed")
abline(v=2020.166667, col="red")
text(x=2020,y=50,"Feb,2020")
text(x=2020,y=40,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2021,y=160,"Jul,2020")
text(x=2021,y=150,"USMCA takes effect")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(Mexico_unTO, type = "l", las = 2, lty=1, ylab = '', main = 'Adaptive Lasso Unweighted VAR(2)')
lines(Mexico_FROM, lty=3)
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.916666, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.583333, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)

plot(to_spillover_ols_mx, type = "l", las = 2, ylab = '', main = 'OLS Unweighted VAR(1)')
lines(from_spillover_ols_mx, lty=3)
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.916666, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.583333, col="red")
legend("topright", legend=c("TO","FROM"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

##pairwise
png("desktop/var(2)/dynamic/pairwise/pairwise_us_cn_lag2.png", width = 4854, height = 3000, res = 350)
plot(GVD_nor_alasso_UStoCN, type = "l",  main = 'US-China', las = 2, ylab = '')
lines(GVD_nor_alasso_CNtoUS, lty=3)
abline(v=2008.75, col="red")
text(x=2009.5,y=12,"Sep,2008")
text(x=2009.5,y=11,"Lehman's collapse")
abline(v=2008.916667, col="red")
text(x=2010.5,y=15,"Nov,2008")
text(x=2010.5,y=14,"quantitative easing and")
text(x=2010.5,y=13,"Chinese economic stimulus plan")
abline(v=2011.583333, col="red")
text(x=2012,y=10,"Jul,2011")
text(x=2012,y=9,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2014,y=8,"Jan,2013")
text(x=2014,y=7,"2013 debt ceiling crisis")
abline(v=2015.666667,col="red")
text(x=2015.5,y=12,"Aug,2015")
text(x=2015.5,y=11,"stock market crash")
abline(v=2016.583333,col="red")
text(x=2016,y=10,"Jul,2016")
text(x=2016,y=9,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=4,"Nov,2016")
text(x=2017.5,y=3,"US presidential election")
abline(v=2017.916667, col="red")
text(x=2017.5,y=15,"Nov,2017")
text(x=2017.5,y=14,"Solar Panels and")
text(x=2017.5,y=13,"washing machines")
abline(v=2018.083333, col="red")
text(x=2018.5,y=12,"Jan,2018")
text(x=2018.5,y=11,"China–United States trade war")
abline(v=2018.5, col="red")
text(x=2019.5,y=14,"June,2018")
text(x=2019.5,y=13,"China retaliates")
abline(v=2020.083333, col="red")
text(x=2021,y=9,"Jan,2020")
text(x=2021,y=8,"Covid-19")
legend("topright", legend=c("United States","China"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/var(2)/dynamic/pairwise/pairwise_us_mx_lag2.png", width = 4854, height = 3000, res = 350)
plot(GVD_nor_alasso_UStoMX, type = "l", main = 'US-Mexico', las = 2, ylab = '', ylim=c(0,14))
lines(GVD_nor_alasso_MXtoUS, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=12,"Sep,2008")
text(x=2009,y=11,"Lehman's collapse")
abline(v=2014.583333, col="red")
text(x=2014.5,y=12,"Jul,2014")
text(x=2014.5,y=11,"American immigration crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=4,"Jul,2017")
text(x=2016,y=3,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=10,"Nov,2016")
text(x=2017.5,y=9,"US presidential election")
abline(v=2018.916667, col="red")
text(x=2018,y=3,"Nov,2018")
text(x=2018,y=2,"USMCA is signed")
abline(v=2020.166667, col="red")
text(x=2020.25,y=9,"Feb,2020")
text(x=2020.25,y=8,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2020.75,y=2,"Jul,2020")
text(x=2020.75,y=1,"USMCA takes effect")
legend("topright", legend=c("United States","Mexico"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/var(2)/dynamic/pairwise/pairwise_us_ru_lag2.png", width = 4854, height = 3000, res = 350)
plot(GVD_nor_alasso_UStoRU, type = "l", main = 'US-Russia', las = 2, ylab = '', ylim=c(0,11))
lines(GVD_nor_alasso_RUtoUS, lty=3)
abline(v=2008.75, col="red")
text(x=2008.5,y=9,"Sep,2008")
text(x=2008.5,y=8,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2012.5,y=9,"Dec,2012")
text(x=2012.5,y=8,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=5,"Feb,2014")
text(x=2014.5,y=4,"Crimean crisis")
abline(v=2016.416667,col="red")
text(x=2016,y=7,"May,2017")
text(x=2016,y=6,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=10,"Nov,2016")
text(x=2017.5,y=9,"US presidential election")
abline(v=2020.166667, col="red")
text(x=2020.5,y=3,"Feb,2020")
text(x=2020.5,y=2,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
legend("topright", legend=c("United States","Russia"), lty=c(1,3))
dev.off()

png("desktop/var(2)/dynamic/pairwise/pairwise_cn_hk_lag2.png", width = 4854, height = 3000, res = 350)
plot(GVD_nor_alasso_CNtoHK, type = "l", main = 'China-HK', las = 2, ylab = '', ylim=c(0,15))
lines(GVD_nor_alasso_HKtoCN, lty=3)
abline(v=2008.75, col="red")
text(x=2009,y=9,"Sep,2008")
text(x=2009,y=8,"Lehman's collapse")
abline(v=2014.75, col="red")
text(x=2014.5,y=8,"Sep,2014")
text(x=2014.5,y=7,"OCLP")
abline(v=2018.083333, col="red")
text(x=2017,y=7,"Jan,2018")
text(x=2017,y=6,"China–United States trade war")
abline(v=2019.25, col="red")
text(x=2019.5,y=10,"Mar,2019")
text(x=2019.5,y=9,"2019 Hong Kong protest")
abline(v=2020.166667, col="red")
text(x=2021,y=8,"Feb,2020")
text(x=2021,y=7,"Covid-19")
legend("topright", legend=c("China","HK"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/var(2)/dynamic/pairwise/pairwise_cn_sk_lag2.png", width = 4854, height = 3000, res = 350)
plot(GVD_nor_alasso_SKtoCN, type = "l", lty=3, main = 'China-South Korea', las = 2, ylab = '')
lines(GVD_nor_alasso_CNtoSK)
abline(v=2008.75, col="red")
text(x=2008.5,y=10,"Sep,2008")
text(x=2008.5,y=9,"Lehman's collapse")
abline(v=2017, col="red")
text(x=2016,y=11,"Dec,2016")
text(x=2016,y=10,"Impeachment of Park Geun-hye")
abline(v=2017.25, col="red")
text(x=2016.5,y=13,"Mar,2017")
text(x=2016.5,y=12,"THAAD")
abline(v=2018.083333, col="red")
text(x=2018.5,y=15,"Jan,2018")
text(x=2018.5,y=14,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2020.5,y=9,"Feb,2020")
text(x=2020.5,y=8,"Covid-19")
legend("topright", legend=c("China","South Korea"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/var(2)/dynamic/pairwise/pairwise_gr_ge_lag2.png", width = 4854, height = 3000, res = 350)
plot(GVD_nor_alasso_GRtoGE, type = "l", main = 'Germany-Greece', las = 2, ylab = '')
lines(GVD_nor_alasso_GEtoGR, lty=3)
abline(v=2008.75, col="red")
text(x=2008.5,y=6,"Sep,2008")
text(x=2008.5,y=5,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=2,"Oct, 2009,")
text(x=2009.5,y=1,"euro debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=8,"May,2010")
text(x=2011,y=7,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012.5,y=4,"Jul,2011")
text(x=2012.5,y=3,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2015,y=4,"Jul,2015")
text(x=2015,y=3,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=8,"Jun,2016")
text(x=2017,y=7,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019.5,y=5,"Feb,2020")
text(x=2019.5,y=4,"Covid-19")
legend("topright", legend=c("Germany","Greece"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()
















### Quadrants
#first window Feb 08
# write.csv(GVD_nor_weighted_To[,,1],"desktop/var(2)/dynamic/first_window_TO.csv")
# write.csv(GVD_nor_weighted_From[,,1],"desktop/var(2)/dynamic/first_window_FROM.csv")

Feb_08_quadrants <- read_excel("~/Desktop/var(2)/dynamic/first_window_quadrant.xlsx")
png("desktop/var(2)/dynamic/Feb_08_quadrants.png", width = 3579, height = 1865, res = 350)
ggplot(Feb_08_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(0,100)) + 
  scale_x_continuous(breaks=seq(0,210,10), limits=c(0,210)) +
  geom_vline(xintercept = mean(Feb_08_quadrants$To)) + geom_hline(yintercept = mean(Feb_08_quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()

#Jan 09
# write.csv(GVD_nor_weighted_To[,,12],"desktop/var(2)/dynamic/afterGFC_TO.csv")
# write.csv(GVD_nor_weighted_From[,,12],"desktop/var(2)/dynamic/afterGFC_FROM.csv")

Jan_09_quadrants <- read_excel("~/Desktop/var(2)/dynamic/afterGFC_quadrant.xlsx")
png("desktop/var(2)/dynamic/Jan_09_quadrants.png", width = 3579, height = 1865, res = 350)
ggplot(Jan_09_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(0,100)) + 
  scale_x_continuous(breaks=seq(0,210,10), limits=c(0,210)) +
  geom_vline(xintercept = mean(Jan_09_quadrants$To)) + geom_hline(yintercept = mean(Jan_09_quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()

#Dec 19
# write.csv(GVD_nor_weighted_To[,,143],"desktop/var(2)/dynamic/before_pendemic_TO.csv")
# write.csv(GVD_nor_weighted_From[,,143],"desktop/var(2)/dynamic/before_pendemic_FROM.csv")

Dec_19_quadrants <- read_excel("~/Desktop/var(2)/dynamic/before_pendemic_quadrant.xlsx")
png("desktop/var(2)/dynamic/Dec_19_quadrants.png", width = 3579, height = 1865, res = 350)
ggplot(Dec_19_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(0,100)) + 
  scale_x_continuous(breaks=seq(0,210,10), limits=c(0,210)) +
  geom_vline(xintercept = mean(Dec_19_quadrants$To)) + geom_hline(yintercept = mean(Dec_19_quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()

#Apr 20
# write.csv(GVD_nor_weighted_To[,,147],"desktop/var(2)/dynamic/during_pendemic_TO.csv")
# write.csv(GVD_nor_weighted_From[,,147],"desktop/var(2)/dynamic/during_pendemic_FROM.csv")

Apr_20_quadrants <- read_excel("~/Desktop/var(2)/dynamic/during_pendemic_quadrant.xlsx")
png("desktop/var(2)/dynamic/Apr_20_quadrants.png", width = 3579, height = 1865, res = 350)
ggplot(Apr_20_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(0,100)) + 
  scale_x_continuous(breaks=seq(0,320,10), limits=c(0,320)) +
  geom_vline(xintercept = mean(Apr_20_quadrants$To)) + geom_hline(yintercept = mean(Apr_20_quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()

#last window June 21
# write.csv(GVD_nor_weighted_To[,,161],"desktop/var(2)/dynamic/last_window_TO.csv")
# write.csv(GVD_nor_weighted_From[,,161],"desktop/var(2)/dynamic/last_window_FROM.csv")

Jun_21_quadrants <- read_excel("~/Desktop/var(2)/dynamic/last_window_quadrant.xlsx")
png("desktop/var(2)/dynamic/Jun_21_quadrants.png", width = 3579, height = 1865, res = 350)
ggplot(Jun_21_quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(0,100,10),limits=c(0,100)) + 
  scale_x_continuous(breaks=seq(0,210,10), limits=c(0,210)) +
  geom_vline(xintercept = mean(Jun_21_quadrants$To)) + geom_hline(yintercept = mean(Jun_21_quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()



#symposium
png("desktop/var(2)/dynamic/USsym.png", width = 5854, height = 3000, res = 350)
plot(US_TO, type = "l", las = 2, lty=1, ylab = '', main = 'US TO spillovers',  lwd = 3)
lines(US_unTO, col = "dodgerblue4", lty=2, lwd = 3)
lines(to_spillover_ols_usa, col = "yellow4", lty=3, lwd =3)
abline(v=2008.75, col="red")
text(x=2009,y=50,"Sep,2008")
text(x=2009,y=40,"Lehman's collapse")
abline(v=2008.916667, col="red")
text(x=2010,y=230,"Nov,2008")
text(x=2010,y=220,"quantitative easing")
abline(v=2016.5, col="red")
text(x=2016,y=250,"Jun,2016")
text(x=2016,y=240,"'Brexit' referendum")
abline(v=2016.583333,col="red")
text(x=2016,y=210,"Jul,2016")
text(x=2016,y=200,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017,y=180,"Nov,2016")
text(x=2017,y=170,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018,y=240,"Jan,2018")
text(x=2018,y=230,"China–United States trade war")
abline(v=2019.75, col="red")
text(x=2019.5,y=220,"Sep,2019")
text(x=2019.5,y=210,"Impeachment inquiry against Trump")
abline(v=2020.083333, col="red")
text(x=2020.5,y=200,"Jan,2020")
text(x=2020.5,y=190,"Covid-19")
abline(v=2020.25, col="red")
text(x=2021,y=70,"Mar,2020")
text(x=2021,y=60,"national lockdown")
legend("topright", legend=c("weighted","unweighted", "OLS"), lty=c(1,2,3), col = c("black", "dodgerblue4", "yellow4"), lwd = 3)
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/var(2)/dynamic/Chinasym.png", width = 5854, height = 3000, res = 350)
plot(China_TO, type = "l", las = 2, lty=1, ylab = '', main = 'China', lwd = 3)
lines(China_unTO, col = "dodgerblue4", lty=2, lwd = 3)
lines(to_spillover_ols_China, col = "yellow4", lty=3, lwd =3)
abline(v=2008.75, col="red")
text(x=2009,y=30,"Sep,2008")
text(x=2009,y=20,"Lehman's collapse")
abline(v=2008.916667, col="red")
text(x=2010,y=110,"Nov,2008")
text(x=2010,y=100,"Chinese economic stimulus plan")
abline(v=2015.666667,col="red")
text(x=2015.5,y=120,"Aug,2015")
text(x=2015.5,y=110,"Chinese stock market crash")
abline(v=2016.583333,col="red")
text(x=2016,y=30,"Jul,2016")
text(x=2016,y=20,"Trump becomes the nominee")
abline(v=2017.083333, col="red")
text(x=2017.5,y=90,"Jan,2017")
text(x=2017.5,y=80,"Inauguration")
abline(v=2018.083333, col="red")
text(x=2018.5,y=120,"Jan,2018")
text(x=2018.5,y=110,"China–United States trade war")
abline(v=2018.5, col="red")
text(x=2019.5,y=30,"June,2018")
text(x=2019.5,y=20,"China retaliates")
abline(v=2020.083333, col="red")
text(x=2021,y=100,"Jan,2020")
text(x=2021,y=90,"Covid-19")
legend("topright", legend=c("weighted","unweighted", "OLS"), lty=c(1,2,3), col = c("black", "dodgerblue4", "yellow4"), lwd = 3)
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/var(2)/dynamic/Greecesym.png", width = 5854, height = 3000, res = 350)
plot(Greece_TO, type = "l", las = 2, lty=1, ylab = '', main = 'Greece', lwd = 3, ylim=c(0,170))
lines(Greece_unTO, col = "dodgerblue4", lty=2, lwd = 3)
lines(to_spillover_ols_Greece, col = "yellow4", lty=3, lwd =3)
abline(v=2008.75, col="red")
text(x=2008.5,y=150,"Sep,2008")
text(x=2008.5,y=140,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=20,"Oct, 2009,")
text(x=2010,y=10,"Pasok wins election")
abline(v=2010, col="red")
text(x=2010.5,y=70,"Dec, 2009,")
text(x=2010.5,y=60,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=50,"May,2010")
text(x=2011,y=40,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012.5,y=70,"Jul,2011")
text(x=2012.5,y=60,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2016,y=140,"Jul,2015")
text(x=2016,y=130,"Third bailout")
abline(v=2020.166667, col="red")
text(x=2021,y=130,"Feb,2020")
text(x=2021,y=120,"Covid-19")
legend("topright", legend=c("weighted","unweighted", "OLS"), lty=c(1,2,3), col = c("black", "dodgerblue4", "yellow4"), lwd = 3)
axis(1, at = c(2007:2022), las = 2)
dev.off()


png("desktop/var(2)/dynamic/USto&from.png", width = 5854, height = 3000, res = 350)
plot(US_TO, type = "l", las = 2, lty=1, ylab = '', main = 'US Spillover',  lwd = 3)
lines(US_FROM, col = "dodgerblue4", lty=2, lwd = 3)
legend("topright", legend=c("TO","FROM"), lty=c(1,2), col = c("black", "dodgerblue4"), lwd = 3)
axis(1, at = c(2007:2022), las = 2)
dev.off()