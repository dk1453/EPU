library(cowplot)
### only run this after runing ols.R and glmnet_alasso.R 
###static###
st_analysis <- cbind(cnct_ols_st$Self, cnct_ols_st$From, cnct_ols_st$To, cnct_ols_st$Net, cnct_alasso_st$Self, cnct_alasso_st$From, cnct_alasso_st$To, cnct_alasso_st$Net)
write.csv(st_analysis,"desktop/typ/st_analysis.csv")

###dynamic###
## total
# png("desktop/typ/overall_spillovers-6.png", width = 2000, height = 3000, res = 350)
# par(mfrow=c(2,1))
# plot(sum_spillover_ols, type = "l", las = 2, ylab = 'Total Spillover', main = 'OLS')
# axis(1, at = c(2007:2022), las = 2)
# plot(total_spillover_alasso, type = "l", las = 2,  ylab = 'Total Spillover', main = 'aLasso')
# axis(1, at = c(2007:2022), las = 2)
# dev.off()

png("desktop/typ/number of zeroes-6.png", width = 4854, height = 3000, res = 350)
plot(numofzero_dy, type = "l", las = 2, ylab="",  yaxt='n', main = '')
lines(numofzero_mean, col='red')
legend("topright", legend=c("percentage","6 month MA"), col=c("black","red"), lty = c(1,1))
axis(1, at = c(2007:2022), las = 2)
axis(2, at=seq(0, 0.5, by=0.05))
dev.off()

png("desktop/typ/overall_spillovers-6.png", width = 4854, height = 3000, res = 350)
plot(sum_spillover_ols, type = "l", las = 2, lty=3, ylab="", main = 'Overall Spillover', ylim=c(1250,2300))
lines(total_spillover_alasso)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2007.666667, col="red")
text(x=2008,y=1300,"Aug, 2007,")
text(x=2008,y=1250,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2008,y=2300,"Sep,2008")
text(x=2008,y=2250,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=1900,"Oct, 2009,")
text(x=2010,y=1850,"European debt crisis")
abline(v=2011.583333, col="red")
text(x=2011.5,y=1800,"Sep,2011")
text(x=2011.5,y=1750,"debt ceiling crisis")
abline(v=2014.166667, col="red")
text(x=2014.5,y=1700,"Feb,2014")
text(x=2014.5,y=1650,"Crimean crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=1400,"Jul,2016")
text(x=2016,y=1350,"Trump becomes the nominee")
abline(v=2016.5, col="red")
text(x=2016,y=2100,"Jun,2016")
text(x=2016,y=2050,"'Brexit' referendum")
abline(v=2016.916667, col="red")
text(x=2018,y=1600,"Nov,2016")
text(x=2018,y=1550,"US presidential election")
abline(v=2018.583333, col="red")
text(x=2018.5,y=2200,"Jul,2018")
text(x=2018.5,y=2150,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2021,y=1600,"Feb,2020")
text(x=2021,y=1550,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

##representative economies
#usa
png("desktop/typ/spillover_usa-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))

plot(to_spillover_ols_usa, type = "l", las = 2, ylab="", lty=3, main = 'USA TO Spillover', ylim=c(50,300))
lines(to_spillover_alasso_usa)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2007.666667, col="red")
abline(v=2008.75, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_usa, type = "l", las = 2, lty=3, ylab = '', main = 'USA From Spillover', ylim=c(60,100))
lines(from_spillover_alasso_usa)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2007.666667, col="red")
abline(v=2008.75, col="red")
abline(v=2011.583333, col="red")
abline(v=2013.5, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_usa, type = "l", las = 2, lty=3, ylab = '', main = 'USA Net Spillover', ylim=c(-40,210))
lines(net_spillover_alasso_usa)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2007.666667, col="red")
text(x=2008,y=110,"Aug, 2007,")
text(x=2008,y=100,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009,y=150,"Sep,2008")
text(x=2009,y=140,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2011,y=150,"Jul,2011")
text(x=2011,y=140,"debt ceiling crisis")
abline(v=2013.5, col="red")
text(x=2013,y=110,"Jun,2013")
text(x=2013,y=100,"taper tatrum")
abline(v=2014.166667, col="red")
text(x=2014.5,y=80,"Feb,2014")
text(x=2014.5,y=70,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2016,y=50,"Jun,2016")
text(x=2016,y=40,"'Brexit' referendum")
abline(v=2016.583333,col="red")
text(x=2016,y=110,"Jul,2016")
text(x=2016,y=100,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=90,"Nov,2016")
text(x=2018,y=80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=150,"Jan,2018")
text(x=2018.5,y=140,"China–United States trade war")
abline(v=2020.166667, col="red")
text(x=2021,y=130,"Feb,2020")
text(x=2021,y=120,"Covid-19")
abline(v=2020.25, col="red")
text(x=2021,y=-10,"Mar,2020")
text(x=2021,y=-20,"national lockdown")
axis(1, at = c(2007:2022), las = 2)
dev.off()


#China
png("desktop/typ/spillover_china-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_China, type = "l", las = 2, lty=3, ylab = '', main = 'China To Spillover')
lines(to_spillover_alasso_China)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.416667, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_China, type = "l", las = 2, lty=3, ylab = '', main = 'China From Spillover', ylim=c(40,100))
lines(from_spillover_alasso_China)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2018.083333, col="red")
abline(v=2019.416667, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_China, type = "l", las = 2, lty=3, ylab = '', main = 'China Net Spillover')
lines(net_spillover_alasso_China)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2010,y=50,"Sep,2008")
text(x=2010,y=40,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2016,y=110,"Jul,2016")
text(x=2016,y=100,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=90,"Nov,2016")
text(x=2018,y=80,"US presidential election")
abline(v=2018.083333, col="red")
text(x=2018.5,y=30,"Jan,2018")
text(x=2018.5,y=20,"China–United States trade war")
abline(v=2019.416667, col="red")
text(x=2019.5,y=60,"May,2019")
text(x=2019.5,y=50,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=30,"Feb,2020")
text(x=2021,y=20,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Germany
png("desktop/typ/spillover_germany-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_Germany, type = "l", las = 2, lty=3, ylab = '', main = 'Germany To Spillover', ylim=c(0,200))
lines(to_spillover_alasso_Germany)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_Germany, type = "l", las = 2, lty=3, ylab = '', main = 'Germany From Spillover', ylim=c(55,100))
lines(from_spillover_alasso_Germany)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
abline(v=2020.25, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_Germany, type = "l", las = 2, lty=3, ylab = '', main = 'Germany Net Spillover', ylim=c(-80,130))
lines(net_spillover_alasso_Germany)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2008,y=50,"Sep,2008")
text(x=2008,y=40,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010.5,y=50,"Oct, 2009,")
text(x=2010.5,y=40,"European debt crisis")
abline(v=2016.5, col="red")
text(x=2017.5,y=-10,"Jun,2016")
text(x=2017.5,y=-20,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019,y=80,"Feb,2020")
text(x=2019,y=70,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
abline(v=2020.25, col="red")
text(x=2021,y=-30,"Mar,2020")
text(x=2021,y=-40,"national lockdown")
dev.off()

#Greece
png("desktop/typ/spillover_greece-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_Greece, type = "l", las = 2, lty=3, ylab = '', main = 'Greece To Spillover', ylim=c(0, 220))
lines(to_spillover_alasso_Greece)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_Greece, type = "l", las = 2, lty=3, ylab = '', main = 'Greece From Spillover', ylim=c(30, 100))
lines(from_spillover_alasso_Greece)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2011.583333, col="red")
abline(v=2015.583333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_Greece, type = "l", las = 2, lty=3, ylab = '', main = 'Greece Net Spillover', ylim=c(-70, 140))
lines(net_spillover_alasso_Greece)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2008,y=-40,"Sep,2008")
text(x=2008,y=-50,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2010,y=-50,"Oct, 2009,")
text(x=2010,y=-60,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=120,"May,2010")
text(x=2011,y=115,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012,y=60,"Jul,2011")
text(x=2012,y=55,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2016,y=-40,"Jul,2015")
text(x=2016,y=-45,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=20,"Jun,2016")
text(x=2017,y=15,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=40,"Feb,2020")
text(x=2021,y=30,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

#South Korea
png("desktop/typ/spillover_sk-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_SK, type = "l", las = 2, lty=3, ylab = '', main = 'South Korea To Spillover', ylim=c(20,220))
lines(to_spillover_alasso_SK)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_SK, type = "l", las = 2, lty=3, ylab = '', main = 'South Korea From Spillover', ylim=c(50,100))
lines(from_spillover_alasso_SK)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2017.25, col="red")
abline(v=2019.583333, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_SK, type = "l", las = 2, lty=3, ylab = '', main = 'South Korea Net Spillover',ylim=c(-80,150))
lines(net_spillover_alasso_SK)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2008,y=40,"Sep,2008")
text(x=2008,y=30,"Lehman's collapse")
abline(v=2017.25, col="red")
text(x=2016.5,y=130,"Mar,2017")
text(x=2016.5,y=120,"THAAD")
abline(v=2019.583333, col="red")
text(x=2019,y=-20,"Jul,2019")
text(x=2019,y=-30,"Japan–South Korea trade dispute")
abline(v=2020.166667, col="red")
text(x=2021,y=70,"Feb,2020")
text(x=2021,y=60,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Mexico
png("desktop/typ/spillover_mexico-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_mx, type = "l", las = 2, lty=3, ylab = '', main = 'Mexico To Spillover')
lines(to_spillover_alasso_mx)
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2019.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_mx, type = "l", las = 2, lty=3, ylab = '', main = 'Mexico From Spillover', ylim=c(50,100))
lines(from_spillover_alasso_mx)
abline(v=2008.75, col="red")
abline(v=2016.583333,col="red")
abline(v=2016.916667, col="red")
abline(v=2019.5, col="red")
abline(v=2020.583333, col="red")
abline(v=2020.166667, col="red")
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_mx, type = "l", las = 2, lty=3, ylab = '', main = 'Mexico Net Spillover')
lines(net_spillover_alasso_mx)
lines(zero, lty=2)
abline(v=2008.75, col="red")
text(x=2009.5,y=20,"Sep,2008")
text(x=2009.5,y=15,"Lehman's collapse")
abline(v=2016.583333,col="red")
text(x=2015.5,y=50,"Jul,2016")
text(x=2015.5,y=45,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2018,y=90,"Nov,2016")
text(x=2018,y=80,"US presidential election")
abline(v=2019.5, col="red")
text(x=2019,y=70,"Jun,2019")
text(x=2019,y=60,"Ratification of USMCA")
abline(v=2020.166667, col="red")
text(x=2020,y=-50,"Feb,2020")
text(x=2020,y=-60,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2021,y=60,"Jul,2020")
text(x=2021,y=50,"USMCA takes effect")
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
axis(1, at = c(2007:2022), las = 2)
dev.off()

#Russia
png("desktop/typ/spillover_russia-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_Russia, type = "l", las = 2, lty=3, ylab = '', main = 'Russia To Spillover')
lines(to_spillover_alasso_Russia)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2012, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_Russia, type = "l", las = 2, lty=3, ylab = '', main = 'Russia From Spillover', ylim=c(30,100))
lines(from_spillover_alasso_Russia)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2012, col="red")
abline(v=2014.166667, col="red")
abline(v=2016.5, col="red")
abline(v=2020.166667, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_Russia, type = "l", las = 2, lty=3, ylab = '', main = 'Russia Net Spillover', ylim=c(-90,60))
lines(net_spillover_alasso_Russia)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2009.5,y=20,"Sep,2008")
text(x=2009.5,y=15,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2011.5,y=20,"Dec,2012")
text(x=2011.5,y=15,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=20,"Feb,2014")
text(x=2014.5,y=15,"Crimean crisis")
abline(v=2016.5, col="red")
text(x=2018,y=20,"Jun,2016")
text(x=2018,y=15,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2021,y=-40,"Feb,2020")
text(x=2021,y=-45,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

#UK
png("desktop/typ/spillover_uk-6.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(3,1))
plot(to_spillover_ols_UK, type = "l", las = 2, lty=3, ylab = '', main = 'UK To Spillover')
lines(to_spillover_alasso_UK)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(from_spillover_ols_UK, type = "l", las = 2, lty=3, ylab = '', main = 'UK From Spillover', ylim=c(40,110))
lines(from_spillover_alasso_UK)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
abline(v=2009.833333, col="red")
abline(v=2010.416667, col="red")
abline(v=2013.083333, col="red")
abline(v=2016.5, col="red")
abline(v=2020.167777, col="red")
abline(v=2020.25, col="red")
axis(1, at = c(2007:2022), las = 2)

plot(net_spillover_ols_UK, type = "l", las = 2, lty=3, ylab = '', main = 'UK Net Spillover')
lines(net_spillover_alasso_UK)
lines(zero, lty=2)
legend("topright", legend=c("OLS","aLasso"), lty=c(3,1))
abline(v=2008.75, col="red")
text(x=2007.5,y=150,"Sep,2008")
text(x=2007.5,y=130,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=110,"Oct, 2009,")
text(x=2009.5,y=90,"European debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=-70,"May, 2010,")
text(x=2011,y=-90,"UK general election")
abline(v=2013.083333, col="red")
text(x=2014,y=90,"Jan, 2013,")
text(x=2014,y=70,"Cameron's promise")
abline(v=2016.5, col="red")
text(x=2017.5,y=150,"Jun,2016")
text(x=2017.5,y=130,"'Brexit' referendum")
abline(v=2020.167777, col="red")
text(x=2019,y=70,"Feb,2020")
text(x=2019,y=50,"Formal 'Brexit'")
abline(v=2020.25, col="red")
text(x=2021,y=70,"Mar,2020")
text(x=2021,y=50,"national lockdown")
axis(1, at = c(2007:2022), las = 2)
dev.off()


##pairwise
png("desktop/typ/pairwise_us_cn-6.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoCN, type = "l",  main = 'US-China', las = 2, ylab = '')
lines(cnct_alasso_CNtoUS, lty=3)
lines(zero, lty=2)
abline(v=2007.666667, col="red")
text(x=2008,y=10,"Aug, 2007,")
text(x=2008,y=9,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009.5,y=12,"Sep,2008")
text(x=2009.5,y=11,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2012,y=10,"Jul,2011")
text(x=2012,y=9,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2014,y=8,"Jan,2013")
text(x=2014,y=7,"2013 debt ceiling crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=10,"Jul,2016")
text(x=2016,y=9,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=4,"Nov,2016")
text(x=2017.5,y=3,"US presidential election")
abline(v=2017.083333, col="red")
text(x=2017.5,y=7,"Jan,2017")
text(x=2017.5,y=6,"Inauguration")
abline(v=2017.916667, col="red")
text(x=2018.5,y=12,"Nov,2017")
text(x=2018.5,y=11,"Solar Panels and")
text(x=2018.5,y=10,"washing machines")
abline(v=2019.416667, col="red")
text(x=2019.5,y=9,"May,2019")
text(x=2019.5,y=8,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=9,"Feb,2020")
text(x=2021,y=8,"Covid-19")
legend("topright", legend=c("United States","China"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/pairwise_us_mx-6.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoMX, type = "l", main = 'US-Mexico', las = 2, ylab = '', ylim=c(0,14))
lines(cnct_alasso_MXtoUS, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("United States","Mexico"), lty=c(1,3))
abline(v=2007.666667, col="red")
text(x=2008,y=10,"Aug, 2007")
text(x=2008,y=9,"subprime mortgage crisis")
abline(v=2008.75, col="red")
text(x=2009,y=12,"Sep,2008")
text(x=2009,y=11,"Lehman's collapse")
abline(v=2011.583333, col="red")
text(x=2010.5,y=2,"Jul,2011")
text(x=2010.5,y=1,"2011 debt ceiling crisis")
abline(v=2013.083333, col="red")
text(x=2012,y=11,"Jan,2013")
text(x=2012,y=10,"2013 debt ceiling crisis")
abline(v=2014.583333, col="red")
text(x=2014.5,y=12,"Jul,2014")
text(x=2014.5,y=11,"American immigration crisis")
abline(v=2016.583333,col="red")
text(x=2016,y=4,"Jul,2017")
text(x=2016,y=3,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=10,"Nov,2016")
text(x=2017.5,y=9,"US presidential election")
abline(v=2018.75, col="red")
text(x=2018,y=3,"Aug,2018")
text(x=2018,y=2,"Settlement between the US and Mexico")
abline(v=2019.5, col="red")
text(x=2019.5,y=11,"Jun,2019")
text(x=2019.5,y=10,"Ratification of Mexico ")
abline(v=2020.166667, col="red")
text(x=2020.25,y=9,"Feb,2020")
text(x=2020.25,y=8,"Covid-19")
abline(v=2020.583333, col="red")
text(x=2020.75,y=2,"Jul,2020")
text(x=2020.75,y=1,"USMCA takes effect")
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/pairwise_us_ru-6.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_UStoRU, type = "l", main = 'US-Russia', las = 2, ylab = '', ylim=c(0,11))
lines(cnct_alasso_RUtoUS, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("United States","Russia"), lty=c(1,3))
abline(v=2008.75, col="red")
text(x=2008,y=8,"Sep,2008")
text(x=2008,y=7,"Lehman's collapse")
abline(v=2012, col="red")
text(x=2012.5,y=9,"Dec,2012")
text(x=2012.5,y=8,"Russian protest")
abline(v=2014.166667, col="red")
text(x=2014.5,y=5,"Feb,2014")
text(x=2014.5,y=4,"Crimean crisis")
abline(v=2016.416667,col="red")
text(x=2016,y=7,"May,2017")
text(x=2016,y=6,"Trump becomes the nominee")
abline(v=2016.916667, col="red")
text(x=2017.5,y=10,"Nov,2016")
text(x=2017.5,y=9,"US presidential election")
abline(v=2020.166667, col="red")
text(x=2020.5,y=3,"Feb,2020")
text(x=2020.5,y=2,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/pairwise_cn_hk-6.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_CNtoHK, type = "l", main = 'China-HK', las = 2, ylab = '', ylim=c(0,11))
lines(cnct_alasso_HKtoCN, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("China","HK"), lty=c(1,3))
abline(v=2008.75, col="red")
text(x=2009,y=9,"Sep,2008")
text(x=2009,y=8,"Lehman's collapse")
abline(v=2014.75, col="red")
text(x=2014.5,y=8,"Sep,2014")
text(x=2014.5,y=7,"OCLP")
abline(v=2018.083333, col="red")
text(x=2017,y=7,"Jan,2018")
text(x=2017,y=6,"China–United States trade war")
abline(v=2019.25, col="red")
text(x=2018.5,y=9,"Mar,2019")
text(x=2018.5,y=8,"2019 Hong Kong protest")
abline(v=2019.416667, col="red")
text(x=2020,y=6,"May,2019")
text(x=2020,y=5,"Entity List")
abline(v=2020.166667, col="red")
text(x=2021,y=8,"Feb,2020")
text(x=2021,y=7,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/pairwise_cn_sk-6.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_SKtoCN, type = "l", lty=3, main = 'China-South Korea', las = 2, ylab = '')
lines(cnct_alasso_CNtoSK)
lines(zero, lty=2)
abline(v=2008.75, col="red")
text(x=2008,y=5,"Sep,2008")
text(x=2008,y=4,"Lehman's collapse")
abline(v=2017.25, col="red")
text(x=2016.5,y=13,"Mar,2017")
text(x=2016.5,y=12,"THAAD")
abline(v=2018.083333, col="red")
text(x=2018.5,y=3,"Jan,2018")
text(x=2018.5,y=2,"China–United States trade war")
abline(v=2019.416667, col="red")
text(x=2019,y=12,"May,2019")
text(x=2019,y=11,"Entity List")
abline(v=2020.166667, col="red")
text(x=2020.5,y=9,"Feb,2020")
text(x=2020.5,y=8,"Covid-19")
legend("topright", legend=c("China","South Korea"), lty=c(1,3))
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/pairwise_gr_ge-6.png", width = 4854, height = 3000, res = 350)
plot(cnct_alasso_GRtoGE, type = "l", main = 'Germany-Greece', las = 2, ylab = '')
lines(cnct_alasso_GEtoGR, lty=3)
lines(zero, lty=2)
legend("topright", legend=c("Germany","Greece"), lty=c(1,3))
abline(v=2008.75, col="red")
text(x=2008,y=6,"Sep,2008")
text(x=2008,y=5,"Lehman's collapse")
abline(v=2009.833333, col="red")
text(x=2009.5,y=2,"Oct, 2009,")
text(x=2009.5,y=1,"euro debt crisis")
abline(v=2010.416667, col="red")
text(x=2011,y=8,"May,2010")
text(x=2011,y=7,"First bailout")
abline(v=2011.583333, col="red")
text(x=2012.5,y=4,"Jul,2011")
text(x=2012.5,y=3,"Second bailout")
abline(v=2015.583333, col="red")
text(x=2015,y=4,"Jul,2015")
text(x=2015,y=3,"Third bailout")
abline(v=2016.5, col="red")
text(x=2017,y=8,"Jun,2016")
text(x=2017,y=7,"'Brexit' referendum")
abline(v=2020.166667, col="red")
text(x=2019.5,y=5,"Feb,2020")
text(x=2019.5,y=4,"Covid-19")
axis(1, at = c(2007:2022), las = 2)
dev.off()

png("desktop/typ/9EPU.png", width = 3000, height = 4854, res = 350)
par(mfrow=c(5,2))
US <- ts(epu[,1], frequency = 12, start = c(2003, 1))
Mexico <- ts(epu[,20], frequency = 12, start = c(2003, 1))
China <- ts(epu[,7], frequency = 12, start = c(2003, 1))
South_Korea <- ts(epu[,19], frequency = 12, start = c(2003, 1))
Hong_Kong <- ts(epu[,14], frequency = 12, start = c(2003, 1))
Germany <- ts(epu[,12], frequency = 12, start = c(2003, 1))
UK <- ts(epu[,24], frequency = 12, start = c(2003, 1))
Russia <- ts(epu[,21], frequency = 12, start = c(2003, 1))
Greece <- ts(epu[,13], frequency = 12, start = c(2003, 1))
plot(US, type="l", main = 'US', ylab = 'EPU')
plot(Mexico, type="l", main = 'Mexico', ylab = 'EPU')
plot(China, type="l", main = 'China', ylab = 'EPU')
plot(South_Korea , type="l", main = 'South Korea', ylab = 'EPU')
plot(Hong_Kong, type="l", main = 'Hong Kong', ylab = 'EPU')
plot(Germany, type="l", main = 'Germany', ylab = 'EPU')
plot(UK, type="l", main = 'UK', ylab = 'EPU')
plot(Russia, type="l", main = 'Russia', ylab = 'EPU')
plot(Greece, type="l", main = 'Greece', ylab = 'EPU')
dev.off()



#ccf
png("desktop/typ/ccf.png", width = 3236, height = 4854, res = 350)
par(mfrow=c(3,2))
ccf(df[,1], df[,7], lag = 30, main = 'ccf of US & China', ylab = 'ccf')
ccf(df[,1], df[,20], lag = 30, main = 'ccf of US & Mexico', ylab = 'ccf')
ccf(df[,1], df[,21], lag = 30, main = 'ccf of US & Russia', ylab = 'ccf')
ccf(df[,7], df[,14], lag = 30, main = 'ccf of China & Hong Kong', ylab = 'ccf')
ccf(df[,7], df[,19], lag = 30, main = 'ccf of China & South Korea', ylab = 'ccf')
ccf(df[,12], df[,13], lag = 30, main = 'ccf of Germany & Greece', ylab = 'ccf')
dev.off()

##plot the quadrants
quadrants <- read_excel("~/Desktop/typ/quadrants.xlsx")
png("desktop/typ/quadrants.png", width = 3570, height = 1865, res = 350)
ggplot(quadrants, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(5,170,10), limits=c(10,170)) +
  # #lims(y=c(70,110),x=c(-50,250)) +
  #coord_fixed() +  # 
  geom_vline(xintercept = mean(quadrants$To)) + geom_hline(yintercept = mean(quadrants$From)) + 
  geom_abline(intercept = 0)
dev.off()

##quadrants of the first window and the last window
#prepare the .csv file
spillover_firstwindow <- cnct_analysis(cnct_alasso_rw[,,1])
spillover_lastwindow <- cnct_analysis(cnct_alasso_rw[,,172])
spillover_FirstWindow <- cbind(spillover_firstwindow$From, spillover_firstwindow$To)
spillover_LastWindow <- cbind(spillover_lastwindow$From, spillover_lastwindow$To)
# write.csv(spillover_FirstWindow,"desktop/typ/spillover_FirstWindow.csv")
# write.csv(spillover_LastWindow, "desktop/typ/spillover_LastWindow.csv")

# plot
FirstWindow <- read_excel("~/Desktop/typ/spillover_FirstWindow.xlsx")
png("desktop/typ/spillover_FirstWindow.png", width = 3579, height = 1865, res = 350)
ggplot(FirstWindow, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(5,170,10), limits=c(10,170)) +
  geom_vline(xintercept = mean(FirstWindow$To)) + geom_hline(yintercept = mean(FirstWindow$From)) + 
  geom_abline(intercept = 0)
dev.off()

LastWindow <- read_excel("~/Desktop/typ/spillover_LastWindow.xlsx")
png("desktop/typ/spillover_LastWindow.png", width = 3570, height = 1865, res = 350)
ggplot(LastWindow, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(5,170,10), limits=c(10,170)) +
  geom_vline(xintercept = mean(LastWindow$To)) + geom_hline(yintercept = mean(LastWindow$From)) + 
  geom_abline(intercept = 0)
dev.off()

png("desktop/typ/spillover_TwoWindows.png", width = 3000, height = 1500, res = 350)
p1 <- ggplot(FirstWindow, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(5,170,10), limits=c(10,170)) +
  geom_vline(xintercept = mean(FirstWindow$To)) + geom_hline(yintercept = mean(FirstWindow$From)) + 
  geom_abline(intercept = 0)
p2 <- ggplot(LastWindow, aes(y=From, x=To, label=country)) +
  geom_text_repel(aes(y=From, x=To, label=country)) +
  geom_point() +
  scale_y_continuous(breaks=seq(30,100,10),limits=c(30,100)) + 
  scale_x_continuous(breaks=seq(5,170,10), limits=c(10,170)) +
  geom_vline(xintercept = mean(LastWindow$To)) + geom_hline(yintercept = mean(LastWindow$From)) + 
  geom_abline(intercept = 0)
plot_grid(p1, p2, labels = c('March, 2007', 'June, 2021'), label_size = 12)
dev.off()


